"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[828],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},u=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=a(e,["components","mdxType","originalType","parentName"]),d=c(n),m=r,f=d["".concat(s,".").concat(m)]||d[m]||p[m]||i;return n?o.createElement(f,l(l({ref:t},u),{},{components:n})):o.createElement(f,l({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=d;var a={};for(var s in t)hasOwnProperty.call(t,s)&&(a[s]=t[s]);a.originalType=e,a.mdxType="string"==typeof e?e:r,l[1]=a;for(var c=2;c<i;c++)l[c]=n[c];return o.createElement.apply(null,l)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3293:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>c});var o=n(7462),r=(n(7294),n(3905));const i={title:"raftt.yml"},l="Raftt Configuration File - raftt.yml",a={unversionedId:"config/raftt.yml",id:"config/raftt.yml",title:"raftt.yml",description:"The configuration of Raftt is located in the raftt.yml file that is created the first time you run raftt up for the repository.",source:"@site/docs/config/raftt.yml.md",sourceDirName:"config",slug:"/config/raftt.yml",permalink:"/config/raftt.yml",draft:!1,tags:[],version:"current",frontMatter:{title:"raftt.yml"},sidebar:"tutorialSidebar",previous:{title:"Configuration",permalink:"/config"},next:{title:"The .raftt File",permalink:"/config/rafttfile"}},s={},c=[{value:"<code>raftt.yml</code> Example",id:"rafttyml-example",level:2},{value:"raftt.yml Specification",id:"rafttyml-specification",level:2},{value:"envDefinition",id:"envdefinition",level:3},{value:"host (optional)",id:"host-optional",level:3},{value:"secrets (optional)",id:"secrets-optional",level:3},{value:"directOptions (optional)",id:"directoptions-optional",level:3},{value:"defaultContext",id:"defaultcontext",level:4},{value:"storageClassName",id:"storageclassname",level:4},{value:"workloadIdentityServiceAccount",id:"workloadidentityserviceaccount",level:4},{value:"useHostPathForVolume",id:"usehostpathforvolume",level:4},{value:"controllerNodeSelector",id:"controllernodeselector",level:4},{value:"podPriorityValue",id:"podpriorityvalue",level:4},{value:"searchLocalDockerRegistry",id:"searchlocaldockerregistry",level:4},{value:"privilegedController",id:"privilegedcontroller",level:4},{value:"controllerResources",id:"controllerresources",level:4},{value:"controllerTolerations",id:"controllertolerations",level:4},{value:"enforceNonRootEnv",id:"enforcenonrootenv",level:4},{value:"controllerPodSecurityContext",id:"controllerpodsecuritycontext",level:4},{value:"controllerSecurityContext",id:"controllersecuritycontext",level:4},{value:"controllerIngress",id:"controlleringress",level:4}],u={toc:c};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"raftt-configuration-file---rafttyml"},"Raftt Configuration File - raftt.yml"),(0,r.kt)("p",null,"The configuration of Raftt is located in the ",(0,r.kt)("inlineCode",{parentName:"p"},"raftt.yml")," file that is created the first time you run ",(0,r.kt)("inlineCode",{parentName:"p"},"raftt up")," for the repository.\n(It can also be created by running ",(0,r.kt)("inlineCode",{parentName:"p"},"raftt setup")," before running ",(0,r.kt)("inlineCode",{parentName:"p"},"raftt up"),").\nOnce the file is created, you need to modify it according to your needs, and we recommend committing it to your repo."),(0,r.kt)("h2",{id:"rafttyml-example"},(0,r.kt)("inlineCode",{parentName:"h2"},"raftt.yml")," Example"),(0,r.kt)("p",null,"See below a sample ",(0,r.kt)("inlineCode",{parentName:"p"},"raftt.yml")," file containing all possible attributes.",(0,r.kt)("br",{parentName:"p"}),"\n","A more detailed explanation can be found ",(0,r.kt)("a",{parentName:"p",href:"#rafttyml-specification"},"below")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yml"},"envDefinition: acme.raftt\nhost: admiral.acme.raftt.io\nsecrets:                                       # Secret fetched from local machine\n  db-password:\n    inputcommand: python3 ./scripts/get_db_password.py\n    outputenv: DB_PASSWORD\ndirectOptions:\n  \n")),(0,r.kt)("h2",{id:"rafttyml-specification"},"raftt.yml Specification"),(0,r.kt)("h3",{id:"envdefinition"},"envDefinition"),(0,r.kt)("p",null,"A top-level element that contains the path to the ",(0,r.kt)("a",{parentName:"p",href:"../config/rafttfile"},(0,r.kt)("inlineCode",{parentName:"a"},".raftt")," file")," containing the environment definition. The filename can be any arbitrary name, but we recommend to use a file extension of ",(0,r.kt)("inlineCode",{parentName:"p"},".raftt")," or ",(0,r.kt)("inlineCode",{parentName:"p"},".rft"),"."),(0,r.kt)("h3",{id:"host-optional"},"host (optional)"),(0,r.kt)("p",null,"A top-level element that configures the accessible host of a dedicated Raftt deployment. ",(0,r.kt)("a",{parentName:"p",href:"https://raftt.io/contact"},"Contact us")," if you'd like one :)."),(0,r.kt)("p",null,'If using connect-mode, this will usually be "direct", which indicates that there is no cluster-level controller, and the lifecycle of the environment controller is managed by the CLI/daemon.'),(0,r.kt)("h3",{id:"secrets-optional"},"secrets (optional)"),(0,r.kt)("p",null,"A dictionary whose keys are the secret names that can be referenced as part of the environment.",(0,r.kt)("br",{parentName:"p"}),"\n","Each dictionary entry contains the following attributes:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"inputcommand")," - The command whose output is the secret.  ",(0,r.kt)("admonition",{parentName:"li",type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"Since this command runs locally, we recommend using an OS-independent command, so the same raftt.yml file can be shared between team members working with different operating systems.",(0,r.kt)("br",{parentName:"p"}),"\n","A possible way to do it is having this command run a short OS-independent python script whose output is the secret.")))),(0,r.kt)("p",null,"The secret value will be accessible in the ",(0,r.kt)("inlineCode",{parentName:"p"},".raftt")," file"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-python"},'aws_creds = get_secret("aws-credentials") # will return "AKIAEXAMPLEAWSCREDS"\n')),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"outputenv")," - The name of the environment variable for which the value will be the output of ",(0,r.kt)("inlineCode",{parentName:"li"},"inputcommand"),".",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"The env var will be accessible for replacing env vars in a docker-compose file like ",(0,r.kt)("inlineCode",{parentName:"li"},"$SECRET-NAME"))))),(0,r.kt)("p",null,"Secrets loaded into Raftt in this way are never persisted, and are available only within the context of the environment - isolated completely from other users. See ",(0,r.kt)("a",{parentName:"p",href:"/intro/how_raftt_works#environment-security-and-isolation"},"Environment Security and Isolation")," for more information."),(0,r.kt)("p",null,"For example, the following raftt.yml definition:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},'secrets:\n  my-vol-secret:\n    inputcommand: echo "abcd"\n  my-env-secret:\n    inputcommand: echo "1234"\n    outputenv: MY_SECRET_ENV\n')),(0,r.kt)("p",null,"Along with the following snippet in the docker-compose:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"services:\n...\n  my_service:\n    ...\n    env:\n      - MY_SECRET_ENV\n    volumes:\n      - /SECRETS/my-vol-secret:/root/secret_file\n")),(0,r.kt)("p",null,"Will make:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"The ",(0,r.kt)("inlineCode",{parentName:"li"},"MY_SECRET_ENV")," env variable in the ",(0,r.kt)("inlineCode",{parentName:"li"},"my_service")," container equal ",(0,r.kt)("inlineCode",{parentName:"li"},"1234"),"."),(0,r.kt)("li",{parentName:"ul"},"The file ",(0,r.kt)("inlineCode",{parentName:"li"},"/root/secret_file")," in the ",(0,r.kt)("inlineCode",{parentName:"li"},"my_service")," container equal ",(0,r.kt)("inlineCode",{parentName:"li"},"abcd"),".")),(0,r.kt)("h3",{id:"directoptions-optional"},"directOptions (optional)"),(0,r.kt)("p",null,"This key contains various customizations to the connect-mode, that may be necessary for your usage of Raftt. Everything here is optional - only add something if you need it."),(0,r.kt)("p",null,"Below is the yaml with all fields filled with valid values. This is almost certainly not what you want!"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"directOptions:\n  defaultContext: dev-cluster\n  storageClassName: gp3\n  workloadIdentityServiceAccount: svc-account-name\n  useHostPathForVolume: false\n  controllerNodeSelector:\n    nodeselectorkey: nodeselectorvalue\n  podPriorityValue: 10\n  searchLocalDockerRegistry: false\n  privilegedController: false\n  controllerResources:\n    requests:\n      cpu: 500m\n      memory: 500Mi\n    limits:\n      cpu: 1000m\n      memory: 1000Mi\n  controllerTolerations:\n    - key: my-toleration\n      operator: Equal\n      value: my-value\n  enforceNonRootEnv: false\n  controllerPodSecurityContext:\n    runAsUser: 1000\n    supplementalGroups:\n      - 1300\n  controllerSecurityContext:\n    runAsUser: 3000\n    runAsGroup: 3000\n  controllerIngress:\n    host: a.b.c.com\n    ingressClass: nginx\n    annotations:\n      my-ingress-annotation: annotation-value\n    maxWaitForIngressSeconds: 15\n    useHTTP: false\n")),(0,r.kt)("h4",{id:"defaultcontext"},"defaultContext"),(0,r.kt)("p",null,"Name of the default Kubernetes context to use. Default: current context."),(0,r.kt)("h4",{id:"storageclassname"},"storageClassName"),(0,r.kt)("p",null,"Name of the storage class to use for the environment controller's persistent volume.\nDefault: null, which will use ",(0,r.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/tasks/administer-cluster/change-default-storage-class/"},"the storage class marked as default in the cluster"),"."),(0,r.kt)("h4",{id:"workloadidentityserviceaccount"},"workloadIdentityServiceAccount"),(0,r.kt)("p",null,"Name of the service account in the namespace to set for the environment controller. See the dedicated ",(0,r.kt)("a",{parentName:"p",href:"/config/image_registries"},"image registries documentation")," for more information."),(0,r.kt)("h4",{id:"usehostpathforvolume"},"useHostPathForVolume"),(0,r.kt)("p",null,"Instead of creating a PVC for the storage used by the environment controller, use a hostPath. This is not recommended for general usage."),(0,r.kt)("h4",{id:"controllernodeselector"},"controllerNodeSelector"),(0,r.kt)("p",null,"The node selectors to apply to the environment controller deployment. If the environment controller should reside on specific nodes only, you can set using this key."),(0,r.kt)("h4",{id:"podpriorityvalue"},"podPriorityValue"),(0,r.kt)("p",null,"Configures a priority for the environment controller deployment and workloads in ",(0,r.kt)("a",{parentName:"p",href:"/concepts/dev_mode"},"dev mode"),". Useful if you encounter problems with scheduling pods and other workloads in the cluster can handle some disruption."),(0,r.kt)("h4",{id:"searchlocaldockerregistry"},"searchLocalDockerRegistry"),(0,r.kt)("p",null,"Whether to search the local docker registry, present if using something like Minikube."),(0,r.kt)("p",null,"See the dedicated ",(0,r.kt)("a",{parentName:"p",href:"/config/image_registries#minikube-local-registry"},"image registries documentation")," for more information."),(0,r.kt)("h4",{id:"privilegedcontroller"},"privilegedController"),(0,r.kt)("p",null,"Whether to bring up the environment controller as privileged. Can be necessary depending on the security configuration of your cluster."),(0,r.kt)("h4",{id:"controllerresources"},"controllerResources"),(0,r.kt)("p",null,"Set the resource requests and limits set on the environment controller deployment. Default is set in above example yaml."),(0,r.kt)("h4",{id:"controllertolerations"},"controllerTolerations"),(0,r.kt)("p",null,"The tolerations to apply to the environment controller deployment."),(0,r.kt)("p",null,"Note - this is a list of the Toleration Kubernetes type, other fields are possible. See ",(0,r.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#toleration-v1-core"},"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#toleration-v1-core"),"."),(0,r.kt)("h4",{id:"enforcenonrootenv"},"enforceNonRootEnv"),(0,r.kt)("p",null,"Causes all the raftt containers (the environment controller and other auxiliary containers) to come up as non-root. This affects behavior in some subtle ways related to file userIDs, but can unblock if certain cluster policies do not allow root."),(0,r.kt)("h4",{id:"controllerpodsecuritycontext"},"controllerPodSecurityContext"),(0,r.kt)("p",null,"Overrides to the environment controller pod security context. Needed if cluster policies require certain settings."),(0,r.kt)("p",null,"Note - this is a Kubernetes type, many fields are possible. See ",(0,r.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#podsecuritycontext-v1-core"},"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#podsecuritycontext-v1-core"),"."),(0,r.kt)("h4",{id:"controllersecuritycontext"},"controllerSecurityContext"),(0,r.kt)("p",null,"Overrides to the environment controller container security context. Needed if cluster policies require certain settings."),(0,r.kt)("p",null,"Note - this is a Kubernetes type, many fields are possible. See ",(0,r.kt)("a",{parentName:"p",href:"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#securitycontext-v1-core"},"https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.28/#securitycontext-v1-core"),"."),(0,r.kt)("h4",{id:"controlleringress"},"controllerIngress"),(0,r.kt)("p",null,"This is a complex field, allowing users of connect-mode to define an optional ",(0,r.kt)("inlineCode",{parentName:"p"},"Ingress")," resource that allows much better connectivity between the developer's machine and the environment controller. The default is connecting over kubernetes port-forward, which is both slower and prone to disconnections."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"ingressClass")," - The class of the ingress to set, if any"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"host")," - the host to set in the IngressRule"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"annotations")," - annotations to add to the created Ingress object"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"maxWaitForIngressSeconds")," - max time to wait for the ingress to be updated with the .Status.LoadBalancer.Ingress field, once it is reconciled. Only relevant if ",(0,r.kt)("inlineCode",{parentName:"li"},"host")," is not specified. Default: 10"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"useHTTP")," - whether to connect over an HTTP websocket instead of HTTPS. Note that no matter what a fully authenticated and encrypted channel (over SSH or QUIC) is tunneled underneath.")),(0,r.kt)("p",null,"Need something else? ",(0,r.kt)("a",{parentName:"p",href:"https://raftt.io/contact"},"Let us know!")))}p.isMDXComponent=!0}}]);